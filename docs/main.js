!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Combobox=e():t.Combobox=e()}(window,(function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=21)}([function(t,e,n){window,t.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e),n.d(e,"BACKSPACE",(function(){return o})),n.d(e,"TAB",(function(){return i})),n.d(e,"ENTER",(function(){return r})),n.d(e,"SHIFT",(function(){return s})),n.d(e,"ESCAPE",(function(){return u})),n.d(e,"SPACE",(function(){return l})),n.d(e,"PAGE_UP",(function(){return a})),n.d(e,"PAGE_DOWN",(function(){return c})),n.d(e,"END",(function(){return h})),n.d(e,"HOME",(function(){return f})),n.d(e,"ARROW_LEFT",(function(){return p})),n.d(e,"ARROW_UP",(function(){return v})),n.d(e,"ARROW_RIGHT",(function(){return d})),n.d(e,"ARROW_DOWN",(function(){return y})),n.d(e,"DELETE",(function(){return b}));var o=8,i=9,r=13,s=16,u=27,l=32,a=33,c=34,h=35,f=36,p=37,v=38,d=39,y=40,b=46}])},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}t.exports=function(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){var o=n(19);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}},function(t,e,n){var o=n(20),i=n(1);t.exports=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?i(t):e}},function(t,e,n){"use strict";var o,i="object"==typeof Reflect?Reflect:null,r=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};o=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!=t};function u(){u.init.call(this)}t.exports=u,t.exports.once=function(t,e){return new Promise((function(n,o){function i(){void 0!==r&&t.removeListener("error",r),n([].slice.call(arguments))}var r;"error"!==e&&(r=function(n){t.removeListener(e,i),o(n)},t.once("error",r)),t.once(e,i)}))},u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var l=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function c(t){return void 0===t._maxListeners?u.defaultMaxListeners:t._maxListeners}function h(t,e,n,o){var i,r,s,u;if(a(n),void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),r=t._events),s=r[e]),void 0===s)s=r[e]=n,++t._eventsCount;else if("function"==typeof s?s=r[e]=o?[n,s]:[s,n]:o?s.unshift(n):s.push(n),(i=c(t))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return t}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(t,e,n){var o={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=f.bind(o);return i.listener=n,o.wrapFn=i,i}function v(t,e,n){var o=t._events;if(void 0===o)return[];var i=o[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):y(i,i.length)}function d(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(t,e){for(var n=new Array(e),o=0;o<e;++o)n[o]=t[o];return n}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),u.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},u.prototype.getMaxListeners=function(){return c(this)},u.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var o="error"===t,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw u.context=s,u}var l=i[t];if(void 0===l)return!1;if("function"==typeof l)r(l,this,e);else{var a=l.length,c=y(l,a);for(n=0;n<a;++n)r(c[n],this,e)}return!0},u.prototype.addListener=function(t,e){return h(this,t,e,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(t,e){return h(this,t,e,!0)},u.prototype.once=function(t,e){return a(e),this.on(t,p(this,t,e)),this},u.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,p(this,t,e)),this},u.prototype.removeListener=function(t,e){var n,o,i,r,s;if(a(e),void 0===(o=this._events))return this;if(void 0===(n=o[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,r=n.length-1;r>=0;r--)if(n[r]===e||n[r].listener===e){s=n[r].listener,i=r;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(o[t]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",t,s||e)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(t){var e,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,r=Object.keys(n);for(o=0;o<r.length;++o)"removeListener"!==(i=r[o])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(o=e.length-1;o>=0;o--)this.removeListener(t,e[o]);return this},u.prototype.listeners=function(t){return v(this,t,!0)},u.prototype.rawListeners=function(t){return v(this,t,!1)},u.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},u.prototype.listenerCount=d,u.prototype.eventNames=function(){return this._eventsCount>0?o(this._events):[]}},function(t,e,n){var o=n(10);t.exports=function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}},function(t,e,n){var o=n(13),i=n(14),r=n(9),s=n(15);t.exports=function(t,e){return o(t)||i(t,e)||r(t,e)||s()}},function(t,e,n){var o=n(16),i=n(17),r=n(9),s=n(18);t.exports=function(t){return o(t)||i(t)||r(t)||s()}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],o=!0,i=!1,r=void 0;try{for(var s,u=t[Symbol.iterator]();!(o=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==u.return||u.return()}finally{if(i)throw r}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){var o=n(10);t.exports=function(t){if(Array.isArray(t))return o(t)}},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e){function n(e,o){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,o)}t.exports=n},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e,n){"use strict";n.r(e);var o=n(2),i=n.n(o),r=n(3),s=n.n(r),u=n(4),l=n.n(u),a=n(11),c=n.n(a),h=n(12),f=n.n(h),p=n(1),v=n.n(p),d=n(6),y=n.n(d),b=n(7),m=n.n(b),x=n(5),E=n.n(x),O=n(8);function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=E()(t);if(e){var i=E()(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return m()(this,n)}}var L=function(t){y()(n,t);var e=g(n);function n(t){var o;return s()(this,n),(o=e.call(this)).rootElement=t,o.textContent=o.rootElement.textContent.trim(),o.textComparison=o.textContent.toLowerCase(),o.handleClick=o.handleClick.bind(v()(o)),o.handleMouseover=o.handleMouseover.bind(v()(o)),o.handleMouseout=o.handleMouseout.bind(v()(o)),o}return l()(n,[{key:"init",value:function(){this.initEvents()}},{key:"initEvents",value:function(){this.rootElement.addEventListener("click",this.handleClick),this.rootElement.addEventListener("mouseover",this.handleMouseover),this.rootElement.addEventListener("mouseout",this.handleMouseout)}},{key:"handleClick",value:function(){this.emit("Option.click",this)}},{key:"handleMouseover",value:function(){this.emit("Option.mouseover")}},{key:"handleMouseout",value:function(){this.emit("Option.mouseout")}},{key:"destroy",value:function(){console.debug("🗑️"),this.destroyEvents()}},{key:"destroyEvents",value:function(){this.rootElement.removeEventListener("click",this.handleClick),this.rootElement.removeEventListener("mouseover",this.handleMouseover),this.rootElement.removeEventListener("mouseout",this.handleMouseout)}}]),n}(O.EventEmitter);function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=E()(t);if(e){var i=E()(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return m()(this,n)}}var w=function(t){y()(n,t);var e=C(n);function n(t,o){var i;return s()(this,n),(i=e.call(this)).rootElement=t,i.combobox=o,i.allOptions=[],i.options=[],i.firstOption=null,i.lastOption=null,i.hasFocus=!1,i.hasHover=!1,i.isOpen=i.rootElement.classList.contains("is-active"),i.handleMouseover=i.handleMouseover.bind(v()(i)),i.handleMouseout=i.handleMouseout.bind(v()(i)),i.handleMouseDown=i.handleMouseDown.bind(v()(i)),i.close=i.close.bind(v()(i)),i}return l()(n,[{key:"init",value:function(){var t=this;f()(this.rootElement.querySelectorAll('[role="option"]')).forEach((function(e){if(!e.firstElementChild||"separator"!==e.getAttribute("role")){var n=new L(e,t);n.init(),t.allOptions.push(n),n.on("Option.mouseout",(function(){t.hasHover=!1,setTimeout((function(){return t.close(!1)}),300)})),n.on("Option.mouseover",(function(){t.hasHover=!0,t.open()})),n.on("Option.click",(function(e){t.setOption(e),t.close(!0),t.emit("Listbox.click",e)}))}})),this.filter(""),this.initEvents()}},{key:"initEvents",value:function(){this.rootElement.addEventListener("mouseover",this.handleMouseover),this.rootElement.addEventListener("mouseout",this.handleMouseout),this.rootElement.addEventListener("mousedown",this.handleMouseDown)}},{key:"handleMouseDown",value:function(t){t.preventDefault()}},{key:"filter",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;if(this.options=[],this.rootElement.innerHTML="",this.options=this.allOptions.filter((function(t){return t.textComparison.toLowerCase().startsWith(e.toLowerCase())})),this.options.forEach((function(e){return t.rootElement.appendChild(e.rootElement)})),0<this.options.length){var o=c()(this.options,1);return this.firstOption=o[0],this.lastOption=this.options[this.options.length-1],n&&0<=this.options.indexOf(n)?n:this.firstOption}return this.firstOption=!1,this.lastOption=!1,!1}},{key:"setCurrentOptionStyle",value:function(t){var e=this;this.options.forEach((function(n){if(n===t)return n.rootElement.setAttribute("aria-selected",!0),void(e.rootElement.scrollTop=n.rootElement.offsetTop);n.rootElement.removeAttribute("aria-selected")}))}},{key:"setOption",value:function(t){console.info("🚩 Listbox.setoption"),t&&this.emit("Listbox.setoption",{option:t})}},{key:"handleMouseover",value:function(){this.hasHover=!0}},{key:"handleMouseout",value:function(){var t=this;this.hasHover=!1,setTimeout((function(){return t.close(!1)}),300)}},{key:"getFirstItem",value:function(){return this.firstOption}},{key:"getLastItem",value:function(){return this.lastOption}},{key:"getPreviousItem",value:function(t){var e=null;return t!==this.firstOption?(e=this.options.indexOf(t),this.options[e-1]):this.lastOption}},{key:"getNextItem",value:function(t){var e=null;return t!==this.lastOption?(e=this.options.indexOf(t),this.options[e+1]):this.firstOption}},{key:"open",value:function(){this.isOpen=!0,this.rootElement.classList.add("is-active"),this.emit("Listbox.open")}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!t&&(this.hasFocus||this.hasHover||this.combobox.hasHover)||(console.info("🚩 Listbox.close"),this.isOpen=!1,this.rootElement.classList.remove("is-active"),this.setCurrentOptionStyle(!1),this.emit("Listbox.close"))}},{key:"destroy",value:function(){console.debug("🗑️ Listbox.destroy"),this.destroyEvents()}},{key:"destroyEvents",value:function(){this.rootElement.removeEventListener("mouseover",this.handleMouseover),this.rootElement.removeEventListener("mouseout",this.handleMouseout)}}]),n}(O.EventEmitter),_=n(0),k=function(t){return 1===t.length&&t.match(/\S/)},A=function(){function t(e,n){s()(this,t),this.rootElement=e,this.$listbox=n,this.option=!1,this.hasFocus=!1,this.hasHover=!1,this.filter="",this.isNone=!1,this.isList=!1,this.isBoth=!1}return l()(t,[{key:"init",value:function(){this.rootElement.setAttribute("aria-haspopup",!0);var t=this.rootElement.getAttribute("aria-autocomplete");"string"==typeof t?(t=t.toLowerCase(),this.isNone="none"===t,this.isList="list"===t,this.isBoth="both"===t):this.isNone=!0,this.listbox=new w(this.$listbox,this),this.listbox.init(),this.initEvents()}},{key:"initEvents",value:function(){var t=this;this.rootElement.addEventListener("keydown",this.handleKeydown.bind(this)),this.rootElement.addEventListener("keyup",this.handleKeyup.bind(this)),this.rootElement.addEventListener("click",this.handleClick.bind(this)),this.rootElement.addEventListener("is-focus",this.handleFocus.bind(this)),this.rootElement.addEventListener("blur",this.handleBlur.bind(this)),this.listbox.on("Listbox.setoption",(function(e){var n=e.option;t.setOption(n),t.setValue(n.textContent)})),this.listbox.on("Listbox.open",(function(){t.rootElement.setAttribute("aria-expanded",!0)})),this.listbox.on("Listbox.close",(function(){t.rootElement.setAttribute("aria-expanded",!1),t.setActiveDescendant()}))}},{key:"handleKeydown",value:function(t){var e,n=this,o=t.altKey,r=t.keyCode,s=(e={},i()(e,_.ENTER,(function(){(n.listbox.focus||n.isBoth)&&n.option&&n.setValue(n.option.textContent),n.listbox.close(!0),t.stopPropagation(),t.preventDefault()})),i()(e,_.ARROW_DOWN,(function(){n.listbox.options.length&&(n.listbox.focus||n.isBoth&&n.option?n.setOption(n.listbox.getNextItem(n.option),!0):(n.listbox.open(),o||n.setOption(n.listbox.getFirstItem(),!0)),n.setVisualFocusListbox()),t.stopPropagation(),t.preventDefault()})),i()(e,_.ARROW_UP,(function(){n.listbox.options.length&&(n.listbox.focus||n.isBoth&&n.option?n.setOption(n.listbox.getPreviousItem(n.option),!0):(n.listbox.open(),o||n.setOption(n.listbox.getLastItem(),!0)),n.setVisualFocusListbox()),t.stopPropagation(),t.preventDefault()})),i()(e,_.ESCAPE,(function(){n.listbox.close(!0),n.setVisualFocusTextbox(),n.setValue(""),n.option=!1})),i()(e,_.TAB,(function(){n.listbox.close(!0),n.listbox.focus&&n.option&&n.setValue(n.option.textContent)})),i()(e,"default",(function(){return!1})),e);return(s[r]||s.default)()}},{key:"handleKeyup",value:function(t){var e=!1,n=t.keyCode,o=t.key;switch(k(o)&&(this.filter+=o),this.rootElement.value.length<this.filter.length&&(this.filter=this.rootElement.value,this.option=!1),n){case _.ESCAPE:return;case _.BACKSPACE:this.setValue(this.rootElement.value),this.setVisualFocusTextbox(),this.listbox.setCurrentOptionStyle(!1),this.option=!1,t.stopPropagation(),t.preventDefault();break;case _.ARROW_LEFT:case _.ARROW_RIGHT:case _.HOME:case _.END:this.isBoth?this.filter=this.rootElement.value:(this.option=!1,this.listbox.setCurrentOptionStyle(!1)),this.setVisualFocusTextbox(),t.stopPropagation(),t.preventDefault();break;default:k(o)&&(this.setVisualFocusTextbox(),this.listbox.setCurrentOptionStyle(!1),t.stopPropagation(),t.preventDefault(),this.isList||this.isBoth?(e=this.listbox.filter(this.filter,this.option))?(!this.listbox.isOpen&&this.rootElement.value.length&&this.listbox.open(),0===e.textComparison.indexOf(this.rootElement.value.toLowerCase())?(this.option=e,(this.isBoth||this.listbox.focus)&&(this.listbox.setCurrentOptionStyle(e),this.isBoth&&k(o)&&this.setOption(e))):(this.option=!1,this.listbox.setCurrentOptionStyle(!1))):(this.listbox.close(),this.option=!1,this.setActiveDescendant()):this.rootElement.value.length&&this.listbox.open())}n!==_.ENTER&&(this.isList||this.isBoth?(e=this.listbox.filter(this.filter,this.option))?(!this.listbox.isOpen&&this.rootElement.value.length&&this.listbox.open(),0===e.textComparison.indexOf(this.rootElement.value.toLowerCase())?(this.option=e,(this.isBoth||this.listbox.focus)&&(this.listbox.setCurrentOptionStyle(e),this.isBoth&&k(o)&&this.setOption(e))):(this.option=!1,this.listbox.setCurrentOptionStyle(!1))):(this.listbox.close(),this.option=!1,this.setActiveDescendant()):this.rootElement.value.length&&this.listbox.open())}},{key:"handleClick",value:function(){return this.listbox.isOpen?this.listbox.close(!0):this.listbox.open()}},{key:"handleFocus",value:function(){this.setVisualFocusTextbox(),this.option=!1,this.listbox.setCurrentOptionStyle(null)}},{key:"handleBlur",value:function(){this.listbox.focus=!1,this.listbox.setCurrentOptionStyle(null),this.removeVisualFocusAll(),setTimeout(this.listbox.close.bind(this.listbox,!1),300)}},{key:"setActiveDescendant",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.rootElement.removeAttribute("aria-activedescendant"),t&&this.listbox.focus&&this.rootElement.setAttribute("aria-activedescendant",t.rootElement.id)}},{key:"setValue",value:function(t){this.filter=t,this.rootElement.value=this.filter,this.rootElement.setSelectionRange(this.filter.length,this.filter.length),(this.isList||this.isBoth)&&this.listbox.filter(this.filter,this.option)}},{key:"setOption",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.option=t,this.listbox.setCurrentOptionStyle(this.option),this.setActiveDescendant(this.option),this.isBoth&&(this.rootElement.value=this.option.textContent,e?this.rootElement.setSelectionRange(this.option.textContent.length,this.option.textContent.length):this.rootElement.setSelectionRange(this.filter.length,this.option.textContent.length))}},{key:"setVisualFocusTextbox",value:function(){this.listbox.rootElement.classList.remove("is-focus"),this.listbox.focus=!1,this.rootElement.parentNode.classList.add("is-focus"),this.hasFocus=!0,this.setActiveDescendant()}},{key:"setVisualFocusListbox",value:function(){this.rootElement.parentNode.classList.remove("is-focus"),this.hasFocus=!1,this.listbox.rootElement.classList.add("is-focus"),this.listbox.focus=!0,this.setActiveDescendant(this.option)}},{key:"removeVisualFocusAll",value:function(){this.rootElement.parentNode.classList.remove("is-focus"),this.hasFocus=!1,this.listbox.rootElement.classList.remove("is-focus"),this.listbox.focus=!0,this.option=!1,this.setActiveDescendant()}}]),t}();e.default=A}])}));